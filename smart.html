<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½ HR åŠ©æ‰‹ - AI é—®ç­”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 20px;
            color: white;
        }
        
        header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        header p {
            opacity: 0.9;
        }
        
        .main-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        
        .nav-links {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .nav-links a {
            color: #667eea;
            text-decoration: none;
            margin: 0 15px;
            font-size: 0.95rem;
        }
        
        .nav-links a:hover {
            text-decoration: underline;
        }
        
        /* è¾“å…¥åŒºåŸŸ */
        .input-section {
            margin-bottom: 30px;
        }
        
        .input-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
            display: block;
        }
        
        .question-input {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1rem;
            resize: vertical;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .question-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }
        
        .question-input::placeholder {
            color: #aaa;
        }
        
        .example-questions {
            margin-top: 15px;
        }
        
        .example-title {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }
        
        .example-tag {
            display: inline-block;
            padding: 8px 15px;
            margin: 5px;
            background: #f0f4ff;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .example-tag:hover {
            background: #667eea;
            color: white;
        }
        
        .submit-btn {
            width: 100%;
            padding: 18px;
            margin-top: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        /* åŠ è½½åŠ¨ç”» */
        .loading-section {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loading-section.active {
            display: block;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ç»“æœåŒºåŸŸ */
        .result-section {
            display: none;
        }
        
        .result-section.active {
            display: block;
        }
        
        .result-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
        }
        
        .result-header h2 {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .matched-skills {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .skill-badge {
            background: rgba(255,255,255,0.2);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        /* å›ç­”å†…å®¹ */
        .answer-section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 1.1rem;
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .answer-content {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            line-height: 1.8;
            color: #444;
        }
        
        .answer-content h3 {
            color: #667eea;
            margin: 20px 0 10px;
        }
        
        .answer-content strong {
            color: #667eea;
        }
        
        /* TODO æ¸…å• */
        .todo-section {
            margin-top: 30px;
        }
        
        .todo-list {
            list-style: none;
        }
        
        .todo-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            transition: all 0.3s;
        }
        
        .todo-item:hover {
            border-color: #667eea;
            transform: translateX(5px);
        }
        
        .todo-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #667eea;
            border-radius: 6px;
            cursor: pointer;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .todo-checkbox.checked {
            background: #667eea;
        }
        
        .todo-checkbox.checked::after {
            content: "âœ“";
            color: white;
            font-size: 14px;
        }
        
        .todo-content {
            flex: 1;
        }
        
        .todo-text {
            font-size: 1rem;
            color: #333;
            margin-bottom: 8px;
        }
        
        .todo-meta {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
        }
        
        .priority {
            padding: 3px 10px;
            border-radius: 10px;
            font-weight: 500;
        }
        
        .priority-high {
            background: #fee;
            color: #c33;
        }
        
        .priority-medium {
            background: #ffeaa7;
            color: #b7791f;
        }
        
        .priority-low {
            background: #e8f5e9;
            color: #2e7d32;
        }
        
        .time-badge {
            color: #666;
        }
        
        /* æ“ä½œæŒ‰é’® */
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #f0f0f0;
        }
        
        .action-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: #667eea;
            color: white;
        }
        
        .export-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }
        
        .export-btn:hover {
            opacity: 0.9;
        }
        
        /* æç¤ºä¿¡æ¯ */
        .tips-section {
            background: #f0f4ff;
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .tips-title {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .tips-list {
            color: #666;
            padding-left: 20px;
        }
        
        .tips-list li {
            margin: 8px 0;
        }

        /* å“åº”å¼ */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .main-card {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¤– æ™ºèƒ½ HR åŠ©æ‰‹</h1>
            <p>è¾“å…¥æ‚¨çš„ç®¡ç†é—®é¢˜ï¼ŒAI è‡ªåŠ¨åŒ¹é…æœ€ä½³ Skills å¹¶ç”Ÿæˆè¡ŒåŠ¨æ¸…å•</p>
        </header>

        <div class="main-card">
            <div class="nav-links">
                <a href="index.html">ğŸ“š æµè§ˆæ‰€æœ‰ Skills</a>
                <span>|</span>
                <a href="smart.html">ğŸ¤– æ™ºèƒ½é—®ç­”</a>
            </div>

            <!-- è¾“å…¥åŒºåŸŸ -->
            <div class="input-section" id="inputSection">
                <label class="input-label">ğŸ’¬ æè¿°æ‚¨é‡åˆ°çš„ç®¡ç†é—®é¢˜</label>
                <textarea 
                    class="question-input" 
                    id="questionInput"
                    placeholder="ä¾‹å¦‚ï¼š
â€¢ æˆ‘æœ€è¿‘è¦é¢è¯•ä¸€ä¸ªæŠ€æœ¯å€™é€‰äººï¼Œä»–æŠ€æœ¯å¾ˆå¼ºä½†æ²Ÿé€šèƒ½åŠ›ä¼¼ä¹ä¸€èˆ¬ï¼Œæˆ‘è¯¥æ€ä¹ˆè¯„ä¼°ï¼Ÿ
â€¢ æœ‰ä¸ªå‘˜å·¥ç»©æ•ˆçªç„¶ä¸‹é™ï¼Œæˆ‘è¯¥æ€ä¹ˆè·Ÿä»–è°ˆï¼Ÿ
â€¢ æ–°å‘˜å·¥å…¥èŒåå¦‚ä½•å¸®åŠ©ä»–å¿«é€Ÿèå…¥å›¢é˜Ÿï¼Ÿ
â€¢ å¦‚ä½•è®¾è®¡æœ‰æ•ˆçš„ç»©æ•ˆè¯„ä¼°ä½“ç³»ï¼Ÿ"></textarea>
                
                <div class="example-questions">
                    <div class="example-title">ğŸ’¡ ç‚¹å‡»å¿«é€Ÿå¡«å……ç¤ºä¾‹é—®é¢˜ï¼š</div>
                    <span class="example-tag" onclick="fillExample('å¦‚ä½•ç»™è¡¨ç°ä¸ä½³çš„å‘˜å·¥è¿›è¡Œç»©æ•ˆé¢è°ˆï¼Ÿ')">ç»©æ•ˆé¢è°ˆ</span>
                    <span class="example-tag" onclick="fillExample('æŠ€æœ¯å¾ˆå¼ºä½†æ²Ÿé€šèƒ½åŠ›å·®çš„å€™é€‰äººï¼Œæ€ä¹ˆè¯„ä¼°æ˜¯å¦å½•ç”¨ï¼Ÿ')">é¢è¯•è¯„ä¼°</span>
                    <span class="example-tag" onclick="fillExample('ä¸€å¯¹ä¸€ä¼šè®®åº”è¯¥æ€ä¹ˆå‡†å¤‡å’Œè¿›è¡Œï¼Ÿ')">ä¸€å¯¹ä¸€ä¼šè®®</span>
                    <span class="example-tag" onclick="fillExample('å‘˜å·¥æå‡ºç¦»èŒï¼Œæˆ‘è¯¥æ€ä¹ˆæŒ½ç•™ï¼Ÿ')">å‘˜å·¥ä¿ç•™</span>
                    <span class="example-tag" onclick="fillExample('å¦‚ä½•å¸®åŠ©å›¢é˜Ÿæˆå‘˜è§„åˆ’èŒä¸šå‘å±•ï¼Ÿ')">èŒä¸šè§„åˆ’</span>
                    <span class="example-tag" onclick="fillExample('æ–°å‘˜å·¥å…¥èŒç¬¬ä¸€ä¸ªæœˆåº”è¯¥å…³æ³¨ä»€ä¹ˆï¼Ÿ')">æ–°å‘˜å·¥èå…¥</span>
                </div>
                
                <button class="submit-btn" onclick="submitQuestion()" id="submitBtn">
                    ğŸš€ è·å–ä¸“ä¸šå»ºè®®å’Œ TODO æ¸…å•
                </button>
            </div>

            <!-- åŠ è½½ä¸­ -->
            <div class="loading-section" id="loadingSection">
                <div class="spinner"></div>
                <p>ğŸ¤” æ­£åœ¨åˆ†æé—®é¢˜å¹¶åŒ¹é…ç›¸å…³çš„ç®¡ç† Skills...</p>
            </div>

            <!-- ç»“æœåŒºåŸŸ -->
            <div class="result-section" id="resultSection">
                <div class="result-header">
                    <h2>ğŸ“‹ åŸºäºæ‚¨çš„é—®é¢˜ï¼Œä¸ºæ‚¨åŒ¹é…äº†ä»¥ä¸‹ Skills</h2>
                    <div class="matched-skills" id="matchedSkills"></div>
                </div>

                <div class="answer-section">
                    <h3 class="section-title">ğŸ’¡ ä¸“ä¸šå»ºè®®</h3>
                    <div class="answer-content" id="answerContent"></div>
                </div>

                <div class="todo-section">
                    <h3 class="section-title">âœ… å»ºè®®è¡ŒåŠ¨æ¸…å• (TODO)</h3>
                    <ul class="todo-list" id="todoList"></ul>
                </div>

                <div class="tips-section">
                    <div class="tips-title">ğŸ“Œ æ¸©é¦¨æç¤º</div>
                    <ul class="tips-list">
                        <li>ç‚¹å‡» TODO é¡¹å‰çš„æ–¹æ¡†å¯æ ‡è®°ä¸ºå·²å®Œæˆ</li>
                        <li>é«˜ä¼˜å…ˆçº§ä»»åŠ¡å»ºè®®ä¼˜å…ˆå¤„ç†</li>
                        <li>å¯åœ¨ Kimi CLI ä¸­è¾“å…¥æ›´å¤æ‚çš„é—®é¢˜è·å¾—æ·±å…¥æŒ‡å¯¼</li>
                    </ul>
                </div>

                <div class="action-buttons">
                    <button class="action-btn" onclick="resetForm()">ğŸ“ æ–°é—®é¢˜</button>
                    <button class="action-btn export-btn" onclick="exportResult()">ğŸ“¥ å¯¼å‡ºç»“æœ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let allSkills = [];
        let currentResponse = null;

        // åŠ è½½ Skills æ•°æ®
        async function loadSkills() {
            try {
                const response = await fetch('data/skills.json');
                allSkills = await response.json();
                console.log(`å·²åŠ è½½ ${allSkills.length} ä¸ª Skills`);
            } catch (error) {
                console.error('åŠ è½½å¤±è´¥:', error);
                alert('æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ data/skills.json æ˜¯å¦å­˜åœ¨');
            }
        }

        // å¡«å……ç¤ºä¾‹é—®é¢˜
        function fillExample(text) {
            document.getElementById('questionInput').value = text;
        }

        // åˆ†è¯
        function tokenize(text) {
            text = text.toLowerCase();
            const englishWords = text.match(/\b[a-z]+\b/g) || [];
            const chineseChars = text.match(/[\u4e00-\u9fff]{2,}/g) || [];
            return [...englishWords, ...chineseChars];
        }

        // ç®€å•çš„ç›¸ä¼¼åº¦è®¡ç®—
        function calculateSimilarity(query, skill) {
            const queryTokens = tokenize(query);
            const skillText = `${skill.name} ${skill.description || ''} ${skill.body || ''}`;
            const skillTokens = tokenize(skillText);
            
            // è®¡ç®— Jaccard ç›¸ä¼¼åº¦ + æ ‡é¢˜åŒ¹é…åŠ æƒ
            const querySet = new Set(queryTokens);
            const skillSet = new Set(skillTokens);
            
            const intersection = new Set([...querySet].filter(x => skillSet.has(x)));
            const union = new Set([...querySet, ...skillSet]);
            
            let score = intersection.size / (union.size || 1);
            
            // æ ‡é¢˜åŒ¹é…åŠ æƒ
            const titleTokens = tokenize(skill.name);
            const titleMatches = [...querySet].filter(x => titleTokens.includes(x)).length;
            score += titleMatches * 0.3;
            
            // å…³é”®è¯ç‰¹æ®ŠåŒ¹é…
            const keywords = {
                'é¢è¯•': ['interview', 'candidate', 'hiring', 'é¢è¯•'],
                'ç»©æ•ˆ': ['performance', 'review', 'è¯„ä¼°', 'ç»©æ•ˆ'],
                'æ™‹å‡': ['promotion', 'career', 'å‘å±•', 'æ™‹å‡'],
                'ç¦»èŒ': ['retention', 'ç¦»èŒ', 'è¾èŒ'],
                'ä¸€å¯¹ä¸€': ['one-on-one', 'ä¸€å¯¹ä¸€', '1:1'],
                'åŸ¹è®­': ['training', 'åŸ¹è®­', 'teaching']
            };
            
            for (const [key, words] of Object.entries(keywords)) {
                if (query.includes(key)) {
                    const hasKeyword = words.some(w => 
                        skillText.toLowerCase().includes(w.toLowerCase())
                    );
                    if (hasKeyword) score += 0.5;
                }
            }
            
            return score;
        }

        // åŒ¹é… Skills
        function matchSkills(question, topK = 3) {
            const scored = allSkills.map(skill => ({
                skill,
                score: calculateSimilarity(question, skill)
            }));
            
            scored.sort((a, b) => b.score - a.score);
            return scored.slice(0, topK).filter(s => s.score > 0);
        }

        // ç”Ÿæˆ TODO æ¸…å•
        function generateTodos(question) {
            const q = question.toLowerCase();
            
            if (q.includes('é¢è¯•') || q.includes('candidate') || q.includes('æ‹›è˜')) {
                return [
                    { task: 'æ˜ç¡®å²—ä½éœ€æ±‚å’Œèƒœä»»åŠ›æ¨¡å‹', priority: 'high', time: 'é¢è¯•å‰ 1-2 å¤©' },
                    { task: 'è®¾è®¡ç»“æ„åŒ–é¢è¯•é—®é¢˜ï¼ˆè¡Œä¸ºé¢è¯•æ³•ï¼‰', priority: 'high', time: 'é¢è¯•å‰ 1 å¤©' },
                    { task: 'å®¡é˜…å€™é€‰äººç®€å†ï¼Œæ ‡æ³¨ç–‘ç‚¹', priority: 'medium', time: 'é¢è¯•å‰ 30 åˆ†é’Ÿ' },
                    { task: 'è¿›è¡Œé¢è¯•ï¼Œè®°å½•å…³é”®ä¿¡æ¯', priority: 'high', time: 'é¢è¯•ä¸­' },
                    { task: 'å¡«å†™é¢è¯•è¯„ä¼°ï¼Œä¸å…¶ä»–é¢è¯•å®˜å¯¹é½', priority: 'high', time: 'é¢è¯•å 24 å°æ—¶å†…' }
                ];
            } else if (q.includes('ç»©æ•ˆ') || q.includes('performance')) {
                return [
                    { task: 'æ”¶é›†å‘˜å·¥ç»©æ•ˆæ•°æ®ï¼ˆäº§å‡ºã€é¡¹ç›®ç»“æœï¼‰', priority: 'high', time: 'é¢è°ˆå‰ 1 å‘¨' },
                    { task: 'å‡†å¤‡æ­£é¢åé¦ˆå’Œæ”¹è¿›å»ºè®®', priority: 'high', time: 'é¢è°ˆå‰ 3 å¤©' },
                    { task: 'é¢„çº¦ä¸€å¯¹ä¸€ä¼šè®®æ—¶é—´', priority: 'medium', time: 'é¢è°ˆå‰ 1 å‘¨' },
                    { task: 'è¿›è¡Œç»©æ•ˆé¢è°ˆï¼ˆå€¾å¬+åé¦ˆï¼‰', priority: 'high', time: 'é¢è°ˆä¸­' },
                    { task: 'å…±åŒåˆ¶å®šæ”¹è¿›è®¡åˆ’æˆ–å‘å±•ç›®æ ‡', priority: 'high', time: 'é¢è°ˆä¸­' }
                ];
            } else if (q.includes('ä¸€å¯¹ä¸€') || q.includes('one-on-one')) {
                return [
                    { task: 'æ”¶é›†è¿‘æœŸå·¥ä½œè¿›å±•å’Œéšœç¢', priority: 'high', time: 'ä¼šè®®å‰' },
                    { task: 'å‡†å¤‡å¼€æ”¾æ€§é—®é¢˜æ¸…å•', priority: 'medium', time: 'ä¼šè®®å‰ 15 åˆ†é’Ÿ' },
                    { task: 'åˆ›å»ºä¼šè®®è®®ç¨‹ï¼ˆå‘˜å·¥ä¸»å¯¼+ç»ç†è¡¥å……ï¼‰', priority: 'medium', time: 'ä¼šè®®å‰' },
                    { task: 'ä¸“æ³¨å€¾å¬ï¼Œåšç¬”è®°', priority: 'high', time: 'ä¼šè®®ä¸­' },
                    { task: 'ç¡®å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨å’Œè´Ÿè´£äºº', priority: 'high', time: 'ä¼šè®®ç»“æŸå‰' }
                ];
            } else if (q.includes('ç¦»èŒ') || q.includes('retention') || q.includes('è¾èŒ')) {
                return [
                    { task: 'å®‰æ’ç¦»èŒé¢è°ˆï¼Œäº†è§£çœŸå®åŸå› ', priority: 'high', time: 'æ”¶åˆ°ç”³è¯·å 24 å°æ—¶' },
                    { task: 'è¯„ä¼°æŒ½ç•™çš„å¯èƒ½æ€§å’Œä»·å€¼', priority: 'high', time: 'ç¦»èŒé¢è°ˆå' },
                    { task: 'å¦‚éœ€æŒ½ç•™ï¼šå‡†å¤‡ counter offer æˆ–æ”¹è¿›æ–¹æ¡ˆ', priority: 'high', time: '2-3 å¤©å†…' },
                    { task: 'å¯åŠ¨çŸ¥è¯†è½¬ç§»å’Œäº¤æ¥è®¡åˆ’', priority: 'high', time: 'ç¡®å®šç¦»èŒæ—¥æœŸå' }
                ];
            } else if (q.includes('æ™‹å‡') || q.includes('promotion') || q.includes('å‘å±•')) {
                return [
                    { task: 'è¯„ä¼°å‘˜å·¥å½“å‰èƒ½åŠ› vs ç›®æ ‡èŒçº§è¦æ±‚', priority: 'high', time: 'æ™‹å‡è®¨è®ºå‰' },
                    { task: 'æ”¶é›† 360 åº¦åé¦ˆ', priority: 'medium', time: 'æ™‹å‡è®¨è®ºå‰ 2 å‘¨' },
                    { task: 'ä¸å‘˜å·¥æ²Ÿé€šèŒä¸šå‘å±•æ„å‘', priority: 'high', time: 'æ™‹å‡è®¨è®ºä¸­' },
                    { task: 'è¯†åˆ«èƒ½åŠ›å·®è·å’Œå‘å±•è®¡åˆ’', priority: 'high', time: 'æ™‹å‡è®¨è®ºä¸­' },
                    { task: 'åˆ¶å®šå…·ä½“çš„æˆé•¿è·¯å¾„å’Œæ—¶é—´è¡¨', priority: 'high', time: 'æ™‹å‡è®¨è®ºå' }
                ];
            } else {
                return [
                    { task: 'æ·±å…¥ç†è§£å½“å‰é—®é¢˜çš„èƒŒæ™¯å’Œå…·ä½“æƒ…å†µ', priority: 'high', time: 'ç«‹å³' },
                    { task: 'æ”¶é›†ç›¸å…³æ•°æ®å’Œä¿¡æ¯', priority: 'high', time: '1-2 å¤©å†…' },
                    { task: 'å‚è€ƒç›¸å…³çš„ç®¡ç† Skills åˆ¶å®šæ–¹æ¡ˆ', priority: 'high', time: 'åˆ†æå' },
                    { task: 'ä¸ç›¸å…³æ–¹æ²Ÿé€šå¹¶è·å¾—åé¦ˆ', priority: 'medium', time: 'æ–¹æ¡ˆåˆ¶å®šå' },
                    { task: 'æ‰§è¡Œè®¡åˆ’å¹¶è·Ÿè¸ªæ•ˆæœ', priority: 'high', time: 'æŒç»­' }
                ];
            }
        }

        // ç”Ÿæˆå›ç­”
        function generateAnswer(question, matchedSkills) {
            if (matchedSkills.length === 0) {
                return "æŠ±æ­‰ï¼Œæ²¡æœ‰æ‰¾åˆ°é«˜åº¦ç›¸å…³çš„ Skillsã€‚å»ºè®®æ‚¨ï¼š\n\n1. ç”¨æ›´å…·ä½“çš„å…³é”®è¯æè¿°é—®é¢˜\n2. æˆ–æµè§ˆ [Skills åˆ—è¡¨](index.html) æ‰‹åŠ¨æŸ¥æ‰¾\n3. ä¹Ÿå¯å°è¯•åœ¨ Kimi CLI ä¸­æé—®è·å¾—æ›´æ™ºèƒ½çš„å›ç­”";
            }

            let answer = `åŸºäºæ‚¨çš„é—®é¢˜ï¼Œæˆ‘ä¸ºæ‚¨æ‰¾åˆ°äº† ${matchedSkills.length} ä¸ªç›¸å…³çš„ç®¡ç† Skillsï¼š\n\n`;
            
            matchedSkills.forEach((item, i) => {
                const s = item.skill;
                const relevance = Math.min(100, Math.round(item.score * 50));
                answer += `${i + 1}. **${s.name}** (ç›¸å…³åº¦: ${relevance}%)\n`;
                answer += `   ${s.description || 'æš‚æ— æè¿°'}\n\n`;
            });

            // æ·»åŠ æ ¸å¿ƒå»ºè®®
            const topSkill = matchedSkills[0].skill;
            answer += `---\n\n### ğŸ’¡ æ ¸å¿ƒå»ºè®®\n\n`;
            
            // æå–å…³é”®å†…å®¹
            const body = topSkill.body || '';
            const paragraphs = body.split('\n\n').filter(p => p.trim().length > 30);
            
            if (paragraphs.length > 0) {
                // å–æœ€ç›¸å…³çš„å‰ä¸¤æ®µ
                answer += paragraphs.slice(0, 2).join('\n\n');
            }

            return answer;
        }

        // æäº¤é—®é¢˜
        async function submitQuestion() {
            const question = document.getElementById('questionInput').value.trim();
            
            if (!question) {
                alert('è¯·è¾“å…¥æ‚¨çš„é—®é¢˜');
                return;
            }

            // æ˜¾ç¤ºåŠ è½½ä¸­
            document.getElementById('inputSection').style.display = 'none';
            document.getElementById('loadingSection').classList.add('active');

            // æ¨¡æ‹Ÿå¼‚æ­¥å¤„ç†ï¼ˆå®é™…è®¡ç®—å¾ˆå¿«ï¼Œä½†ä¸ºäº†ç”¨æˆ·ä½“éªŒï¼‰
            setTimeout(() => {
                // åŒ¹é… Skills
                const matched = matchSkills(question, 3);
                
                // ç”Ÿæˆå›ç­”
                const answer = generateAnswer(question, matched);
                
                // ç”Ÿæˆ TODO
                const todos = generateTodos(question);
                
                // ä¿å­˜å“åº”
                currentResponse = {
                    question,
                    matched,
                    answer,
                    todos
                };
                
                // æ˜¾ç¤ºç»“æœ
                displayResult(currentResponse);
                
                // éšè—åŠ è½½ï¼Œæ˜¾ç¤ºç»“æœ
                document.getElementById('loadingSection').classList.remove('active');
                document.getElementById('resultSection').classList.add('active');
            }, 800);
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResult(response) {
            // åŒ¹é…çš„æŠ€èƒ½
            const skillsContainer = document.getElementById('matchedSkills');
            skillsContainer.innerHTML = response.matched.map(m => 
                `<span class="skill-badge">${m.skill.name}</span>`
            ).join('');

            // å›ç­”å†…å®¹
            const answerHtml = response.answer
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/### (.*)/g, '<h3>$1</h3>')
                .replace(/---/g, '<hr>')
                .replace(/\n/g, '<br>');
            document.getElementById('answerContent').innerHTML = answerHtml;

            // TODO åˆ—è¡¨
            const todoContainer = document.getElementById('todoList');
            const priorityClass = {
                'high': 'priority-high',
                'medium': 'priority-medium',
                'low': 'priority-low'
            };
            const priorityText = {
                'high': 'é«˜',
                'medium': 'ä¸­',
                'low': 'ä½'
            };
            
            todoContainer.innerHTML = response.todos.map((todo, i) => `
                <li class="todo-item">
                    <div class="todo-checkbox" onclick="toggleTodo(this, ${i})"></div>
                    <div class="todo-content">
                        <div class="todo-text">${todo.task}</div>
                        <div class="todo-meta">
                            <span class="priority ${priorityClass[todo.priority]}">
                                ${priorityText[todo.priority]}ä¼˜å…ˆçº§
                            </span>
                            <span class="time-badge">â° ${todo.time}</span>
                        </div>
                    </div>
                </li>
            `).join('');
        }

        // åˆ‡æ¢ TODO å®ŒæˆçŠ¶æ€
        function toggleTodo(checkbox, index) {
            checkbox.classList.toggle('checked');
        }

        // é‡ç½®è¡¨å•
        function resetForm() {
            document.getElementById('questionInput').value = '';
            document.getElementById('resultSection').classList.remove('active');
            document.getElementById('inputSection').style.display = 'block';
            currentResponse = null;
        }

        // å¯¼å‡ºç»“æœ
        function exportResult() {
            if (!currentResponse) return;

            const text = `
========================================
æ™ºèƒ½ HR åŠ©æ‰‹ - é—®é¢˜åˆ†ææŠ¥å‘Š
========================================

é—®é¢˜ï¼š${currentResponse.question}

åŒ¹é…åˆ°çš„ Skillsï¼š
${currentResponse.matched.map(m => `- ${m.skill.name}`).join('\n')}

----------------------------------------
ä¸“ä¸šå»ºè®®
----------------------------------------
${currentResponse.answer.replace(/\*\*/g, '').replace(/### /g, '')}

----------------------------------------
è¡ŒåŠ¨æ¸…å• (TODO)
----------------------------------------
${currentResponse.todos.map((t, i) => `${i + 1}. [ ] ${t.task}
   ä¼˜å…ˆçº§: ${t.priority === 'high' ? 'é«˜' : t.priority === 'medium' ? 'ä¸­' : 'ä½'} | æ—¶é—´: ${t.time}`).join('\n\n')}

----------------------------------------
ç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString()}
åŸºäº Andy Groveã€ŠHigh Output Managementã€‹
========================================
            `.trim();

            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `HRåˆ†ææŠ¥å‘Š_${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // åˆå§‹åŒ–
        loadSkills();
    </script>
</body>
</html>
